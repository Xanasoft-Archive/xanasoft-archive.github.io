(()=>{"use strict";var t={752:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractModule=void 0,e.AbstractModule=class{constructor(t,e=null){this.plugin=t,this.webHelpers=e||this.plugin.getWebHelpers()}}},217:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Gateway=void 0,e.Gateway=class{constructor(t){this.lastVerifiedTxId="",this.config=t}generateRandomTxId(t){const e=this.getRandomString(4,!1),o=Math.floor(Date.now()/1e3);return this.lastVerifiedTxId=`${t}-${o}-${e}`,this.lastVerifiedTxId}getLastGeneratedTxId(){return this.lastVerifiedTxId}getPayFrameUrl(t,e,o,i="Post",s=""){const n=this.generateRandomTxId(t);o=o.toUpperCase();const r=encodeURI(0!==s.length?s:`Post ${t} @ ${this.config.siteUrl}`.trim());return this.config.frameUrl.replace("{verifiedTxId}",n).replace("{amount}",e.toFixed(8)).replace("{currency}",o).replace("{desc}",r)}getRandomString(t,e=!1){let o=e?"1234567890ABCDEF":"1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",i="";for(let e=0;e<t;e++)i+=o.charAt(Math.floor(Math.random()*o.length));return i}}},107:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Payment=void 0;const i=o(752),s=o(863),n=o(217),r=o(949),a=o(524);class l extends i.AbstractModule{constructor(t){super(t),this.payments=new r.PaymentMap,this.paymentType="WP",this.currentPayID="",this.gateway=new n.Gateway(this.plugin.getConfig());const e=this.plugin.getConfig();this.addPayFrameListeners(),this.plugin.$(this.plugin.window.document).ready((t=>{void 0!==e.woocommerce&&!0===e.woocommerce.paymentPage?this.paymentType="WC":0!==this.plugin.$("h3.rcp_header").length&&(this.paymentType="RCP")}))}addPayFrameListeners(){const t=this.plugin.getConfig(),e=e=>{if(e.origin!==t.gatewayOrigin)return void this.webHelpers.log(["Skipped message from different origin:",e.origin,t.gatewayOrigin]);let o=e.data;if("string"==typeof o.func&&"function"==typeof this[o.func])try{this[o.func].call(this,o.data)}catch(t){console.error("Error calling trusted event callback function: ",t)}};window.addEventListener?window.addEventListener("message",e,!1):window.attachEvent&&window.attachEvent("onmessage",e,!1)}onVpayPaid(t){return new Promise(((e,o)=>{t&&"PAID"===t.status?!0!==this.plugin.getConfig().reloadAfterPay||this.plugin.window.location.reload():this.webHelpers.log(["received payment with invalid state",t.status])}))}onVpayReturnToMerchant(t){this.plugin.window.location.reload()}onVpayFrameSize(t){this.plugin.$(".ct-frame-pay iframe").height(t.height).attr("height",t.height)}showPaymentFrame(t){this.plugin.$(".ct-button-frame").fadeOut("slow"),this.plugin.$(".ct-button-wrap").fadeIn("slow");const e=this.plugin.getConfig(),o=this.plugin.$(t),i=o.attr("data-id");this.currentPayID=i;const n=new a.PaymentButtonID(i),r=parseFloat(o.attr("data-amount")),l=o.attr("data-currency");this.plugin.$(".ct-btn-wrap-"+i).fadeOut("slow");const c=document.createElement("iframe"),p="WC"===this.paymentType?e.tr.order:e.tr.post;c.src=this.gateway.getPayFrameUrl(n.postID,r,l,p,"WooCommerce Order"),c.scrolling="no",c.style.overflow="hidden",c.width="400px",c.height="800px";const d=this.plugin.$(".ct-button-frame-"+i);d.append(c),d.fadeIn("slow");const u=this.gateway.getLastGeneratedTxId();let h=new s.PaymentResponse;"1"===o.attr("data-restricted")&&(h.is_restricted=!0),this.payments.set(u,h)}updateEditableButtonAmount(t){this.plugin.getConfig();const e=this.plugin.$(t),o=parseFloat(e.val()),i=this.plugin.$(".ct-btn-wrap-"+this.currentPayID);i.find(".ct-button-tip").attr("data-amount",o),i.find(".ct-btn-display-amount").text(o)}scheduleRemovePayFrame(){const t=this.plugin.getConfig(),e="WC"===this.paymentType?5:0,o=".ct-button-frame-"+("WP"===this.paymentType?0:t.woocommerce.orderID)+", .ct-button-frame-"+this.currentPayID;setTimeout((()=>{this.plugin.$(o).fadeOut("slow"),setTimeout((()=>{this.plugin.$(o).remove()}),1e3)}),1e3*e)}}e.Payment=l},730:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VerifiedPay=void 0;const i=o(853),s=o(143),n=o(107),r=o(576);class a{constructor(t,e){this.window=t,this.$=e,this.config=this.window.verifiedPayCfg||{},this.config.consentCookieName=a.CONSENT_COOKIE_NAME,this.config.confirmCookiesMsg=a.CONFIRM_COOKIES_MSG,this.config.confirmCookiesBtn=a.CONFIRM_COOKIES_BTN,this.webHelpers=new s.WebHelpers(this.window,this.$,this.config),this.tooltips=new i.Tooltips(this,this.webHelpers),this.adminControls=new r.AdminControls(this),this.payment=new n.Payment(this),this.$(this.window.document).ready((t=>{this.adminControls.init(),this.webHelpers.checkCookieConsent()}))}getConfig(){return this.config}getTooltips(){return this.tooltips}getWebHelpers(){return this.webHelpers}}e.VerifiedPay=a,a.CONSENT_COOKIE_NAME="vp-ck",a.CONFIRM_COOKIES_MSG="#ct-cookieMsg",a.CONFIRM_COOKIES_BTN="#ct-confirmCookies"},143:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WebHelpers=void 0,e.WebHelpers=class{constructor(t,e,o){this.cssSelectors=[],this.window=t,this.$=e,this.config=o}getBrowserLang(){return this.window.navigator.language.substr(0,2).toLowerCase()}getCookie(t){let e,o,i,s=this.window.document.cookie.split(";");for(e=0;e<s.length;e++)if(o=s[e].substr(0,s[e].indexOf("=")),i=s[e].substr(s[e].indexOf("=")+1),o=o.replace(/^\s+|\s+$/g,""),o==t)return decodeURI(i);return null}setCookie(t,e,o){let i=new Date;i=new Date(i.getTime()+864e5*(o||this.config.cookieLifeDays)),this.window.document.cookie=t+"="+e+"; expires="+i.toUTCString()+"; path="+this.config.cookiePath}removeCookie(t){this.window.document.cookie=t+"=; expires=Thu, 02 Jan 1970 00:00:00 UTC; path="+this.config.cookiePath}checkCookieConsent(){this.$(this.config.confirmCookiesBtn).click((()=>{this.confirmCookies()})),null!==this.getCookie(this.config.consentCookieName)&&this.$(this.config.confirmCookiesMsg).remove()}fromBase64(t){return"function"!=typeof this.window.atob?(this.window.console.error("Base64 decoding is not supported in your browser"),""):this.window.atob(t)}toBase64(t){return"function"!=typeof this.window.btoa?(this.window.console.error("Base64 encoding is not supported in your browser"),""):this.window.btoa(t)}translate(t,e,o=!1){if("string"!=typeof t)try{t=t.toString()}catch(e){return this.log("Text to translate is not a string"),t}let i=0,s=0;for(;-1!==(i=t.indexOf("{",i));){if(i>0&&"\\"===t.charAt(i-1)){i++;continue}if(s=t.indexOf("}",i),-1===s){this.log("Can not find end position while translating HTML");break}let n=t.substring(i+1,s),r=null;if("tr:"===n.substring(0,3)){let t=n.substring(3);r=this.tr(t)}else if("object"==typeof e){let t=e[n];void 0!==t&&(r="boolean"==typeof o&&o?t:this.escapeOutput(t))}if(null!==r){let e=new RegExp("\\{"+n+"\\}","g");t=t.replace(e,r)}else if(null!==n.match("^[A-Za-z0-9_]+$")){this.log("No translation found for place holder: "+n);let e=new RegExp("\\{"+n+"\\}","g");t=t.replace(e,"MISSING: "+this.escapeOutput(n))}else i+=n.length}return t.replace(/\\\\\\{/,"{")}escapeOutput(t,e=!0){return"string"!=typeof t||(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),void 0!==e&&!0!==e||(t=t.replace(/\r?\n/g,"<br>"))),t}escapeRegex(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}tr(t){return t}log(t){"object"==typeof this.window.console&&"function"==typeof this.window.console.log&&this.window.console.log(arguments)}isAppleIOS(){return/iPad|iPhone|iPod/.test(this.window.navigator.userAgent)&&!this.window.MSStream}getAllCssSelectors(t=!0){if(!0===t&&0!==this.cssSelectors.length)return this.cssSelectors;this.cssSelectors=[];try{const t=new RegExp("^"+this.escapeRegex(this.window.document.location.origin),"i");for(let e=0;e<this.window.document.styleSheets.length;e++){const o=this.window.document.styleSheets[e];if(!o.href||!1!==t.test(o.href)){if(o.rules)for(let t=0;t<o.rules.length;t++)o.rules[t].selectorText&&this.cssSelectors.push(o.rules[t].selectorText);if(o.imports)for(let t=0;t<o.imports.length;t++)for(let e=0;e<o.imports[t].rules.length;e++)o.imports[t].rules[e].selectorText&&this.cssSelectors.push(o.imports[t].rules[e].selectorText)}}}catch(t){this.window.console.error("Error getting CSS selectors",t)}return this.cssSelectors}isExistingCssSelector(t){const e=this.getAllCssSelectors();for(let o=0;o<e.length;o++)if(e[o]===t)return!0;return!1}confirmCookies(){this.$(this.config.confirmCookiesMsg).remove(),this.setCookie(this.config.consentCookieName,"1",this.config.cookieLifeDays)}getApi(t,e,o,i){"function"==typeof e?(o=e,e=null):void 0===e&&(e=null);let s=this.fixRelativeUrl(t);return this.$.get(s,e,((t,e,i)=>{o(t,e,i)}),i)}postApi(t,e,o,i){let s=this.fixRelativeUrl(t);return this.$.post(s,e,((t,e,i)=>{o(t,e,i)}),i)}fixRelativeUrl(t){if(0===t.toLowerCase().indexOf("http"))return t;let e=this.config.siteUrl;return 0!==t.length&&"/"===t[0]&&"/"===e[e.length-1]&&(e=e.substr(0,e.length-1)),e+=t,e}}},576:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AdminControls=void 0;const i=o(752);class s extends i.AbstractModule{constructor(t){super(t)}init(){-1!==this.plugin.$("body").attr("class").indexOf("verifiedpay")&&(this.plugin.getTooltips().initToolTips(),this.plugin.$(this.plugin.window.document).ready((t=>{})))}}e.AdminControls=s},853:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Tooltips=void 0;const i=o(752);class s extends i.AbstractModule{constructor(t,e){super(t,e)}initToolTips(){const t=this.plugin.window,e=this.plugin.$,o=this,i=!1;let s=0,n=!1;const r=function(t,o=!1){o=o||!1;let i="pointerdown.tsfTT touchstart.tsfTT click.tsfTT",s=e(t);o?(s.off("mousemove mouseleave mouseout ct-tooltip-update"),e(document.body).off(i)):(s.on({mousemove:l,mouseleave:c,mouseout:c}),e(document.body).off(i).on(i,p)),s.on("ct-tooltip-update",a)},a=function(t){if(t.target.classList.contains("ct-tooltip-item")){let e=t.target.querySelector(".ct-tooltip-text");e instanceof Element&&(e.innerHTML=t.target.dataset.desc)}},l=function(t){let o=e(t.target),i=o.find(".ct-tooltip"),s=i.find(".ct-tooltip-arrow"),n=i.data("overflow"),r=i.data("overflowDir");if(n=parseInt(n,10),n=isNaN(n)?0:-Math.round(n),n)s.css(r,n+"px");else{let e=t.originalEvent&&t.originalEvent.pageX||t.pageX,n=7,r=16,a=o.closest(".ct-tooltip-wrap"),l=e-a.offset().left-r/2,c=i.find(".ct-tooltip-text-wrap"),p=c.outerWidth(!0),d=i.data("adjust"),u=i.data("adjustDir"),h=p-r-n;d=parseInt(d,10),d=isNaN(d)?0:Math.round(d),d&&(d="left"===u?-d:d,l+=d,h-d>a.outerWidth(!0))&&(h=c.find(".ct-tooltip-text").outerWidth(!0)-r-n),l<=n?s.css("left",n+"px"):l>=h?s.css("left",h+"px"):s.css("left",l+"px")}},c=function(t){var o;n||(e(t.target).find(".ct-tooltip").remove(),o=t.target,r(o,!0))},p=function(o){n=!0,clearTimeout(s),s=t.setTimeout((function(){n=!1}),250);let i,r=".ct-tooltip",a=e(o.target);if(a.hasClass("ct-tooltip-item")&&(i=a.find(r)),!i){let t=a.children(".ct-tooltip-item");t.length&&(i=t.find(r))}i&&i.length?e(r).not(i).remove():e(r).remove()},d=function(t){if(n)return;let o=!1;switch(t.type){case"mouseenter":break;case"pointerdown":case"touchstart":o=!0}if(t.target.classList.contains("ct-tooltip-item"))o&&p(t),function(t){let o=e(t.target),i=t.target.dataset.desc;if(i&&0===o.find("div").length){t.target.title="";let s=e('<div class="ct-tooltip"><span class="ct-tooltip-text-wrap"><span class="ct-tooltip-text">'+i+'</span></span><div class="ct-tooltip-arrow"></div></div>');o.append(s);let n=o.closest(".ct-tooltip-boundary");n=n.length&&n||e(document.body);let r=o.outerHeight()+9,a=s.offset().top-r;n.offset().top-(n.prop("scrolltop")||0)>a?(s.addClass("ct-tooltip-down"),s.css("top",r+"px")):s.css("bottom",r+"px");let l=o.closest(".ct-tooltip-wrap"),c=s.find(".ct-tooltip-text-wrap"),p=c.find(".ct-tooltip-text"),d=l.width(),u=c.outerWidth(!0),h=p.outerWidth(!0),g=c.offset().left,f=g+h,w=n.offset().left-(n.prop("scrollLeft")||0),m=w+n.outerWidth(),y="left";if(g<w){let t=w-g+12,e=parseInt(c.css("flex-basis"),10);t<-e&&(t=-e),s.css(y,t+"px"),s.data("overflow",t),s.data("overflowDir",y)}else if(f>m){let t=m-f-d-12,e=parseInt(c.css("flex-basis"),10);t<-e&&(t=-e),s.css(y,t+"px"),s.data("overflow",t),s.data("overflowDir",y)}else if(d<42){let t=-15;s.css(y,t+"px"),s.data("overflow",t),s.data("overflowDir",y)}else if(d>u){let e=(t.originalEvent&&t.originalEvent.pageX||t.pageX)-l.offset().left-u/2,o=e+u;e<0?e=0:o>d&&(e=d-h),s.css(y,e+"px"),s.data("adjust",e),s.data("adjustDir",y)}}}(t),l(t),r(t.target);else{let o=t.target.querySelector(".ct-tooltip-item:hover"),s=new e.Event(t.type);s.pageX=t.originalEvent&&t.originalEvent.pageX||t.pageX,o?(i&&console.log("Tooltip event warning: delegation"),e(o).trigger(s)):(i&&console.log("Tooltip event warning: bubbling"),e(t.target).closest(".ct-tooltip-wrap").find(".ct-tooltip-item:hover").trigger(s))}t.stopPropagation()},u=function(){let t=e(".ct-tooltip-wrap");t.off("mouseenter pointerdown touchstart"),t.on("mouseenter pointerdown touchstart",".ct-tooltip-item",d)};u(),e(t).on("ct-reset-tooltips",u),function(){let t=e("#wpcontent");o.addTooltipBoundary(t)}()}addTooltipBoundary(t){jQuery(t).addClass("ct-tooltip-boundary")}_triggerTooltipReset(){jQuery(window).trigger("ct-reset-tooltips")}_triggerTooltipUpdate(t){jQuery(t).trigger("ct-tooltip-update")}}e.Tooltips=s},524:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PaymentButtonID=void 0,e.PaymentButtonID=class{constructor(t){this.postID=0,this.buttonNr=0;const e=t.split("-");if(2!==e.length)throw new Error("PaymentButtonID must have exactly 2 parts: postID-buttonNr");this.postID=parseInt(e[0]),this.buttonNr=parseInt(e[1])}getButtonIdStr(){return`${this.postID}-${this.buttonNr}`}}},949:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PaymentMap=void 0;class o extends Map{constructor(){super()}mergeWithExisting(t,e){let o=this.get(t);return void 0!==o&&(e.is_restricted=o.is_restricted),this.set(t,e),e}}e.PaymentMap=o},863:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PaymentResponse=void 0;class o{constructor(){this.is_restricted=!1}static fromJson(t){return Object.assign(new o,t)}}e.PaymentResponse=o}},e={};function o(i){var s=e[i];if(void 0!==s)return s.exports;var n=e[i]={exports:{}};return t[i](n,n.exports,o),n.exports}(()=>{let t=new(o(730).VerifiedPay)(window,jQuery);window.verifiedPayPlugin=t})()})();
//# sourceMappingURL=bundle.js.map